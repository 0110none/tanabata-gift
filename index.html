<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ä¸ƒå¤•ã®é¡˜ã„æ˜Ÿ | Tanabata Wishes</title>
  <meta name="description" content="æ˜Ÿã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã€ä¸ƒå¤•ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã£ã¦ã­ã€‚" />
  <style>
    :root{
      --bg:#040814;
      --fg:#fff;
      --accent:#ffd86b;
      --overlay:rgba(0,0,0,.35);  /* èƒŒæ™¯å›¾ä¸Šå ä¸€å±‚æš—è‰²ï¼Œæå‡å¯è¯»æ€§ */
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html,body{ height:100%; margin:0; }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic UI","PingFang SC","Microsoft YaHei",sans-serif;
      background: var(--bg);
      color:var(--fg);
      display:flex; align-items:center; justify-content:center;
      padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
      -webkit-font-smoothing:antialiased;
      touch-action: manipulation; /* iOS ç‚¹æŒ‰æ›´çµæ• */
    }

    header{
      position:fixed; top:calc(8px + env(safe-area-inset-top)); left:0; right:0;
      text-align:center; padding:0 16px; pointer-events:none;
      text-shadow:0 2px 6px rgba(0,0,0,.45);
    }
    h1{ margin:0 0 6px; font-size:clamp(18px,4.5vw,28px); letter-spacing:.04em; }
    p.lead{ margin:0; opacity:.9; font-size:clamp(12px,3.6vw,16px); }

    .sky{
      position:relative;
      width:min(560px, 92vw); height:min(560px, 92vw);
      border-radius:20px; overflow:hidden;
      box-shadow:0 12px 40px rgba(0,0,0,.45);
      background:
        /* â†“ æ›¿æ¢ä¸ºä½ çš„èƒŒæ™¯å›¾ï¼ˆæ­¥éª¤è§ä¸‹æ–‡ï¼‰ */
        linear-gradient(var(--overlay),var(--overlay)),
        url("./star.png") center/cover no-repeat,
        radial-gradient(60% 60% at 70% 30%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(50% 50% at 30% 70%, rgba(255,255,255,.06), transparent 60%),
        #030815;
      will-change:transform;
    }

    /* èƒŒæ™¯æ˜Ÿå°˜ï¼ˆè½»é‡ï¼‰ */
    .dust{ position:absolute; inset:0; pointer-events:none; background:
      radial-gradient(1px 1px at 10% 20%, #fff 50%, transparent 52%),
      radial-gradient(1px 1px at 30% 80%, #fff 50%, transparent 52%),
      radial-gradient(1px 1px at 70% 30%, #fff 50%, transparent 52%),
      radial-gradient(1px 1px at 85% 60%, #fff 50%, transparent 52%),
      radial-gradient(1px 1px at 50% 50%, #fff 50%, transparent 52%),
      radial-gradient(1px 1px at 20% 65%, #fff 50%, transparent 52%);
      opacity:.35; filter:drop-shadow(0 0 3px rgba(255,255,255,.3));
    }

    .star{
      position:absolute;
      width:36px; height:36px; border:0; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #fff 40%, var(--accent) 41%, rgba(255,216,107,.35) 62%, transparent 72%);
      cursor:pointer; touch-action: manipulation;
      transition: transform .12s ease, filter .2s ease;
      animation: twinkle 2.4s infinite ease-in-out;
      filter: drop-shadow(0 0 6px rgba(255,216,107,.7));
      transform: translateZ(0); /* iOS GPU åŠ é€Ÿ */
    }
    .star:active{ transform:scale(.9); }
    @media (hover:hover){ .star:hover{ transform:scale(1.08); } }
    @keyframes twinkle{ 0%,100%{opacity:.95} 50%{opacity:.55} }

    .msg{
      position:absolute; left:50%; bottom:12px; transform:translateX(-50%);
      width:min(520px, 88vw);
      background: rgba(10,14,28,.76); backdrop-filter: blur(8px);
      border:1px solid rgba(255,255,255,.14); border-radius:16px;
      padding:14px 16px; text-align:center;
      font-size:clamp(14px, 3.6vw, 16px); line-height:1.6;
      box-shadow:0 10px 30px rgba(0,0,0,.45);
    }
    .msg b{ color:var(--accent); }

    .share{
      position:absolute; right:12px; top:12px;
      background: rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.18);
      color:#fff; border-radius:999px; padding:8px 12px; font-size:12px;
      cursor:pointer; touch-action:manipulation;
      backdrop-filter: blur(6px);
    }

    @media (prefers-reduced-motion: reduce){
      .star{ animation:none }
    }
  </style>
</head>
<body>
  <header>
    <h1>ä¸ƒå¤•ã®é¡˜ã„æ˜Ÿ âœ¨</h1>
    <p class="lead">å¥½ããªæ˜Ÿã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã­ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šãã¾ã™ï¼‰</p>
  </header>

  <div class="sky" id="sky" aria-label="tanabata sky">
    <div class="dust" aria-hidden="true"></div>
    <p class="msg" id="msg">æ˜Ÿã‚’é¸ã¶ã¨ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç¾ã‚Œã‚‹ã‚ˆã€‚<br><b>Happy Tanabata</b> ğŸ‹</p>
    <button class="share" id="shareBtn" type="button">Share</button>
  </div>

  <script>
    // ç¥ç¦è¯­ï¼šå¯è‡ªè¡Œå¢åˆ ï¼Œæ”¯æŒä¸­æ—¥åŒè¯­
    const WISHES = [
      "ä¸ƒå¤•ã®å¤œã€å›ã®å¹¸ã›ã‚’ç¥ˆã£ã¦ã„ã¾ã™ã€‚â­ï¸",
      "ã„ã¤ã‚‚ç¬‘é¡”ã§ã„ã¦ã­ã€‚ğŸ˜Š",
      "ã¾ãŸä¼šãˆã‚‹æ—¥ã‚’æ¥½ã—ã¿ã«ã—ã¦ã‚‹ã€‚ğŸŒ™",
      "ã‚ãªãŸã®æ¯æ—¥ãŒã€æ˜Ÿã®ã‚ˆã†ã«è¼ãã¾ã™ã‚ˆã†ã«ã€‚âœ¨",
      "ä»Šå¤©ä¹Ÿè¦å¼€å¼€å¿ƒå¿ƒå“¦ï¼ğŸˆ",
      "æ„¿æˆ‘ä»¬ä¸‹æ¬¡è§é¢æ›´é è¿‘å½¼æ­¤çš„å¿ƒã€‚ğŸ’",
      "å›ã®å­˜åœ¨ã ã‘ã§ã€ä¸–ç•ŒãŒã‚„ã•ã—ããªã‚‹ã€‚ğŸ’«",
    ];

    const sky = document.getElementById("sky");
    const msg = document.getElementById("msg");

    // â­ ä¸ƒé¢—æ˜Ÿ
    const STAR_COUNT = 7;

    // åœ¨ç›¸å¯¹å®‰å…¨çš„å¯ç‚¹åŒºåŸŸå†…éšæœºæ‘†æ”¾ï¼ˆé¿å…è¢«æ¶ˆæ¯æ¡†æŒ¡ä½ï¼‰
    function randomPos(){
      const left = 8 + Math.random()*84;     // 8% ~ 92%
      const top  = 10 + Math.random()*64;    // 10% ~ 74%
      return {left, top};
    }

    for (let i = 0; i < STAR_COUNT; i++){
      const s = document.createElement("button");
      s.className = "star"; s.type = "button"; s.setAttribute("aria-label","star");
      const {left, top} = randomPos();
      s.style.left = left + "%";
      s.style.top  = top  + "%";

      // å°ºå¯¸éšè®¾å¤‡è‡ªé€‚åº”ï¼ŒiPhone ä¸Šè§¦æ§é¢ç§¯æ›´å¤§
      const base = Math.min(window.innerWidth, 560);
      const size = Math.max(32, Math.round(base/18 + Math.random()*6));
      s.style.width = s.style.height = size + "px";

      // äº¤äº’
      s.addEventListener("click", () => {
        const text = WISHES[Math.floor(Math.random()*WISHES.length)];
        msg.textContent = text;
      });

      // ç¨å¾®é”™å³°é—ªçƒ
      s.style.animationDelay = (Math.random()*2.4).toFixed(2) + "s";
      sky.appendChild(s);
    }

    // åˆ†äº«æŒ‰é’®ï¼ˆiOS Safari æ”¯æŒ Web Share APIï¼‰
    document.getElementById("shareBtn").addEventListener("click", async () => {
      const shareData = { title:"ä¸ƒå¤•ã®é¡˜ã„æ˜Ÿ", text:"æ˜Ÿã‚’é¸ã‚“ã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã£ã¦ã­ğŸ‹", url: location.href };
      try{
        if (navigator.share){ await navigator.share(shareData); }
        else {
          await navigator.clipboard.writeText(location.href);
          alert("Link copied!");
        }
      }catch(e){
        await navigator.clipboard.writeText(location.href);
        alert("Link copied!");
      }
    });
  </script>
</body>
</html>
